(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1513:function(e,t,s){Promise.resolve().then(s.bind(s,4853))},4853:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var l=s(7437),r=s(2265);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:m,...h}=e;return(0,r.createElement)("svg",{ref:t,...n,width:l,height:l,stroke:s,strokeWidth:c?24*Number(i)/Number(l):i,className:a("lucide",o),...h},[...m.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),o=((e,t)=>{let s=(0,r.forwardRef)((s,l)=>{let{className:n,...o}=s;return(0,r.createElement)(c,{ref:l,iconNode:t,className:a("lucide-".concat(i(e)),n),...o})});return s.displayName="".concat(e),s})("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);function d(e){var t,s,r;let{latest:i}=e,a=null!==(s=null==i?void 0:i.symbol)&&void 0!==s?s:"SPY",n=null!==(r=null==i?void 0:null===(t=i.underlier)||void 0===t?void 0:t.price)&&void 0!==r?r:0,c=(null==i?void 0:i.ts)?new Date(i.ts).toLocaleTimeString():"";return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(o,{className:"h-5 w-5"}),(0,l.jsx)("span",{className:"font-medium",children:a}),(0,l.jsx)("span",{className:"opacity-70",children:n.toFixed(2)})]}),(0,l.jsx)("div",{className:"text-xs opacity-60",children:c})]})}function m(e){let{ivGrid:t}=e,s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=s.current;if(!e||0===t.length)return;let l=e.getContext("2d");if(!l)return;let r=window.devicePixelRatio||1,i=e.width=Math.floor(e.clientWidth*r),a=e.height=Math.floor(360*r),n=Array.from(new Set(t.map(e=>e.k))).sort((e,t)=>e-t),c=Array.from(new Set(t.map(e=>e.t))).sort((e,t)=>e-t),o=new Map(n.map((e,t)=>[e,t])),d=new Map(c.map((e,t)=>[e,t])),m=n.length,h=c.length,x=i/Math.max(1,m),u=a/Math.max(1,h),f=t.map(e=>e.iv),v=Math.min(...f),j=Math.max(...f);if(!Number.isFinite(v)||!Number.isFinite(j))return;let p=e=>j===v?.5:(e-v)/(j-v);l.clearRect(0,0,i,a),t.forEach(e=>{let t=(o.get(e.k)||0)*x,s=(d.get(e.t)||0)*u,r=p(e.iv);l.fillStyle="rgb(".concat(Math.floor(20+100*r),",").concat(Math.floor(80+100*r),",").concat(Math.floor(200+30*r),")"),l.fillRect(t,s,Math.ceil(x),Math.ceil(u))}),l.strokeStyle="rgba(255,255,255,0.08)";for(let e=0;e<=m;e++)l.beginPath(),l.moveTo(e*x,0),l.lineTo(e*x,a),l.stroke();for(let e=0;e<=h;e++)l.beginPath(),l.moveTo(0,e*u),l.lineTo(i,e*u),l.stroke()},[t]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:"IV Surface"}),(0,l.jsx)("div",{className:"text-xs opacity-60",children:"k=strike, t=days"})]}),(0,l.jsx)("canvas",{ref:s,className:"w-full h-[360px] rounded-xl border border-white/10"})]})}function h(e){let{arb:t}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:"Arbitrage Checks"}),(0,l.jsx)("div",{className:"text-xs opacity-60",children:"butterfly / calendar"})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"text-left opacity-70",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2",children:"Type"}),(0,l.jsx)("th",{children:"Expiry"}),(0,l.jsx)("th",{children:"Strikes"}),(0,l.jsx)("th",{children:"Metric"}),(0,l.jsx)("th",{children:"Status"})]})}),(0,l.jsx)("tbody",{children:null==t?void 0:t.slice(0,50).map((e,t)=>(0,l.jsxs)("tr",{className:"border-t border-white/10 hover:bg-white/5",children:[(0,l.jsx)("td",{className:"py-2",children:e.type}),(0,l.jsx)("td",{children:e.expiry}),(0,l.jsx)("td",{children:Array.isArray(e.strikes)?e.strikes.join(", "):""}),(0,l.jsx)("td",{className:"font-mono",children:"number"==typeof e.metric?e.metric.toFixed(4):"-"}),(0,l.jsx)("td",{className:e.flagged?"text-red-400":"text-emerald-400",children:e.flagged?"VIOLATION":"OK"})]},t))})]})})]})}function x(e){let{forecasts:t}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"AI IV Forecast (short horizon)"}),(0,l.jsx)("ul",{className:"space-y-2",children:null==t?void 0:t.slice(0,8).map((e,t)=>(0,l.jsxs)("li",{className:"flex items-center justify-between text-sm",children:[(0,l.jsxs)("span",{className:"opacity-70",children:["t+",e.t,"m"]}),(0,l.jsxs)("span",{className:"font-mono",children:[(100*e.iv).toFixed(2),"% ",(0,l.jsxs)("span",{className:"opacity-60",children:["[",(100*e.ci[0]).toFixed(1),"%, ",(100*e.ci[1]).toFixed(1),"%]"]})]})]},t))})]})}function u(e){var t;let{arb:s}=e,r=(null!==(t=null==s?void 0:s.filter(e=>e.flagged))&&void 0!==t?t:[]).slice(0,20),i=e=>{var t;let s=Math.abs(Number(null!==(t=e.metric)&&void 0!==t?t:0)),r=s>.01?"HIGH":s>.001?"MED":"LOW",i="HIGH"===r?"bg-red-500/20 text-red-300":"MED"===r?"bg-amber-500/20 text-amber-300":"bg-emerald-500/20 text-emerald-300";return(0,l.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat(i),children:r})};return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Arbitrage Alerts"}),0===r.length?(0,l.jsx)("div",{className:"text-sm opacity-70",children:"No violations detected."}):(0,l.jsx)("ul",{className:"space-y-2 text-sm",children:r.map((e,t)=>{var s;return(0,l.jsxs)("li",{className:"flex items-start justify-between gap-3",children:[(0,l.jsxs)("div",{className:"min-w-0",children:[(0,l.jsxs)("div",{className:"font-medium flex items-center gap-2",children:[(0,l.jsx)("span",{className:"opacity-80",children:e.type}),i(e)]}),(0,l.jsx)("div",{className:"opacity-70 break-words",children:null!==(s=e.detail)&&void 0!==s?s:""})]}),(0,l.jsxs)("div",{className:"text-right opacity-60 shrink-0",children:[(0,l.jsx)("div",{children:e.expiry}),(0,l.jsx)("div",{className:"font-mono",children:Array.isArray(e.strikes)?e.strikes.join(", "):""})]})]},t)})})]})}function f(e){let{series:t}=e,s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=s.current;if(!e||!(null==t?void 0:t.length))return;let l=e.getContext("2d");if(!l)return;let r=window.devicePixelRatio||1,i=e.width=Math.floor(e.clientWidth*r),a=e.height=Math.floor(200*r);l.clearRect(0,0,i,a);let n=t.map((e,t)=>t),c=t.map(e=>e.atmIv),o=Math.max(0,.98*Math.min(...c)),d=1.02*Math.max(...c),m=e=>i*(1-e/Math.max(1,n.length-1)),h=e=>a-(e-o)/Math.max(1e-9,d-o)*a;l.strokeStyle="rgba(255,255,255,0.08)";for(let e=0;e<5;e++){let t=a*e/4;l.beginPath(),l.moveTo(0,t),l.lineTo(i,t),l.stroke()}l.beginPath(),l.moveTo(m(0),h(c[0]));for(let e=1;e<c.length;e++)l.lineTo(m(e),h(c[e]));l.strokeStyle="rgba(120,180,255,0.9)",l.lineWidth=2*r,l.stroke()},[t]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:"ATM IV (history)"}),(0,l.jsx)("div",{className:"text-xs opacity-60",children:"last ~3–5 min"})]}),(0,l.jsx)("canvas",{ref:s,className:"w-full h-[200px] rounded-xl border border-white/10"})]})}function v(e){let{grid:t,field:s}=e,i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=i.current;if(!e||!(null==t?void 0:t.length))return;let l=e.getContext("2d");if(!l)return;let r=Array.from(new Set(t.map(e=>e.k))).sort((e,t)=>e-t),a=Array.from(new Set(t.map(e=>e.t))).sort((e,t)=>e-t),n=new Map(r.map((e,t)=>[e,t])),c=new Map(a.map((e,t)=>[e,t])),o=window.devicePixelRatio||1,d=e.width=Math.floor(e.clientWidth*o),m=e.height=Math.floor(260*o),h=d/Math.max(1,r.length),x=m/Math.max(1,a.length),u=t.map(e=>e[s]),f=Math.min(...u),v=Math.max(...u)||1,j=e=>v===f?.5:(e-f)/(v-f);l.clearRect(0,0,d,m),t.forEach(e=>{let t=(n.get(e.k)||0)*h,r=(c.get(e.t)||0)*x,i=j(e[s]);l.fillStyle="rgb(".concat(Math.floor(30+80*i),",").concat(Math.floor(60+140*i),",").concat(Math.floor(220-120*i),")"),l.fillRect(t,r,Math.ceil(h),Math.ceil(x))}),l.strokeStyle="rgba(255,255,255,0.08)";for(let e=0;e<=r.length;e++)l.beginPath(),l.moveTo(e*h,0),l.lineTo(e*h,m),l.stroke();for(let e=0;e<=a.length;e++)l.beginPath(),l.moveTo(0,e*x),l.lineTo(d,e*x),l.stroke()},[t,s]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("h3",{className:"text-lg font-medium",children:["Greeks Heatmap — ",s]}),(0,l.jsx)("div",{className:"text-xs opacity-60",children:"k=strike, t=days"})]}),(0,l.jsx)("canvas",{ref:i,className:"w-full h-[260px] rounded-xl border border-white/10"})]})}function j(){let[e,t]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=new EventSource("/api/stream");return e.onmessage=e=>{try{let s=JSON.parse(e.data);t(e=>[s,...e].slice(0,200))}catch(e){}},e.onerror=()=>e.close(),()=>e.close()},[]);let s=e[0],i=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.ivGrid)&&void 0!==e?e:[]},[s]),a=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.arb)&&void 0!==e?e:[]},[s]),n=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.forecast)&&void 0!==e?e:[]},[s]),c=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.history)&&void 0!==e?e:[]},[s]),o=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.greeks)&&void 0!==e?e:[]},[s]);return(0,l.jsxs)("main",{className:"grid gap-6 md:grid-cols-3",children:[(0,l.jsxs)("section",{className:"md:col-span-2 card p-4 space-y-4",children:[(0,l.jsx)(d,{latest:s}),(0,l.jsx)(m,{ivGrid:i}),(0,l.jsx)(f,{series:c})]}),(0,l.jsxs)("aside",{className:"card p-4 space-y-4",children:[(0,l.jsx)(x,{forecasts:n}),(0,l.jsx)(u,{arb:a})]}),(0,l.jsxs)("section",{className:"md:col-span-3 grid md:grid-cols-3 gap-4",children:[(0,l.jsx)("div",{className:"card p-4",children:(0,l.jsx)(v,{grid:o,field:"delta"})}),(0,l.jsx)("div",{className:"card p-4",children:(0,l.jsx)(v,{grid:o,field:"gamma"})}),(0,l.jsx)("div",{className:"card p-4",children:(0,l.jsx)(v,{grid:o,field:"vega"})})]}),(0,l.jsx)("section",{className:"md:col-span-3 card p-4",children:(0,l.jsx)(h,{arb:a})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=1513)}),_N_E=e.O()}]);